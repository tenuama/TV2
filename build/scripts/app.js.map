{"version":3,"sources":["app.js"],"names":["screen","input","frames","spFrame","lvFrame","mSprite","lSprite","monsters","dir","lazer","bullets","Menu","constructor","t","$","on","close","fadeOut","main","Screen","width","height","canvas","document","createElement","context","getContext","getElementById","appendChild","drawSprite","sp","x","y","drawImage","img","w","h","clear","clearRect","drawBullet","fillStyle","bullet","color","fillRect","InputHandeler","down","pressed","addEventListener","e","keyCode","isDown","code","isPressed","Sprite","Bullet","vely","update","init","sprite","rows","i","len","length","j","a","push","run","loop","render","window","requestAnimationFrame","Math","max","min","_max","_min","save","restore","Image","src","ready","menu"],"mappings":"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","file":"app.js","sourcesContent":["var screen, input, frames, spFrame, lvFrame;\r\nvar mSprite, lSprite;\r\nvar monsters, dir, lazer, bullets;\r\n\r\nclass Menu {\r\n    constructor() {\r\n        let t = this;\r\n        $('#startgame').on('click', function() {\r\n            t.close();\r\n        });\r\n    }\r\n    close() {\r\n        $('#menu').fadeOut(function() {\r\n            main();\r\n        });\r\n    }\r\n}\r\n\r\nclass Screen {\r\n    constructor(width, height) {\r\n        let t = this;\r\n        t.canvas = document.createElement(\"canvas\");\r\n        t.context = t.canvas.getContext(\"2d\");\r\n        t.canvas.width = t.width = width;\r\n        t.canvas.height = t.height = height;\r\n\r\n        document.getElementById(\"gamezone\").appendChild(this.canvas);\r\n    }\r\n    drawSprite(sp, x, y) {\r\n        this.context.drawImage(sp.img, sp.x, sp.y, sp.w, sp.h, x, y , sp.w, sp.h);\r\n    }\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.width, this.height);\r\n    }\r\n    drawBullet() {\r\n        let t = this;\r\n        t.context.fillStyle = bullet.color;\r\n        t.context.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);\r\n    }\r\n}\r\n\r\nclass InputHandeler {\r\n    constructor() {\r\n        let t = this;\r\n        t.down = {};\r\n        t.pressed = {};\r\n\r\n        document.addEventListener(\"keydown\", function(e) {\r\n            t.down[e.keyCode] = true;\r\n        });\r\n        document.addEventListener(\"keyup\", function(e) {\r\n            delete t.down[e.keyCode];\r\n            delete t.pressed[e.keyCode];\r\n        });\r\n    }\r\n    isDown(code) {\r\n        return this.down[code];\r\n    }\r\n    isPressed(code) {\r\n        let t = this;\r\n        if (t.pressed[code]) {\r\n            return false;\r\n        } else if (t.down[code]) {\r\n            return t.pressed[code] = true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\nclass Sprite {\r\n    constructor(img, x, y, w, h) {\r\n        let t = this;\r\n        t.img = img;\r\n        t.x = x;\r\n        t.y = y;\r\n        t.w = w;\r\n        t.h = h;\r\n    }\r\n};\r\n\r\nclass Bullet {\r\n    constructor(x, y, vely, w, h, color) {\r\n        let t = this;\r\n        t.x = x;\r\n        t.y = y;\r\n        t.vely = vely;\r\n        t.width = w;\r\n        t.height = h;\r\n        t.color = color;\r\n    }\r\n    update() {\r\n        let t = this;\r\n        t.y += t.vely;\r\n    }\r\n};\r\n\r\nfunction init() {\r\n    frames = 0;\r\n    spFrame = 0;\r\n    lvFrame = 60;\r\n    dir = 1;\r\n\r\n    lazer = {\r\n        sprite: lSprite,\r\n        x: (screen.width - lSprite.w)/2,\r\n        y: screen.height - (30 + lSprite.h)\r\n    };\r\n\r\n    bullets = [];\r\n\r\n    monsters = [];\r\n    var rows = [0, 1, 1, 2, 2];\r\n\r\n    for (var i = 0, len = rows.length; i < len; i++) {\r\n        for (var j = 0; j < 10; j++) {\r\n            var a = rows[i];\r\n            monsters.push({\r\n                sprite: mSprite[a],\r\n                x: 30 + j*30,\r\n                y: 30 + i*30,\r\n                w: mSprite[a][0].w,\r\n                h: mSprite[a][0].h\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nfunction run() {\r\n    var loop = function() {\r\n        update();\r\n        render();\r\n        window.requestAnimationFrame(loop, screen.canvas);\r\n    };\r\n    window.requestAnimationFrame(loop, screen.canvas);\r\n};\r\n\r\nfunction update() {\r\n\r\n    if (input.isDown(37)) { //left\r\n        lazer.x -= 4;\r\n    }\r\n    if (input.isDown(39)) { //right\r\n        lazer.x += 4;\r\n    }\r\n\r\n    lazer.x = Math.max(Math.min(lazer.x, screen.width - (30 + lSprite.w)), 30);\r\n\r\n    frames++;\r\n    if (frames % lvFrame === 0) {\r\n        spFrame = (spFrame + 1) % 2;\r\n\r\n        var _max = 0,\r\n            _min = screen.width;\r\n\r\n        for (var i = 0, len = monsters.length; i < len; i++) {\r\n            var a = monsters[i];\r\n            a.x += 30 * dir;\r\n\r\n            _max = Math.max(_max, a.x + a.w);\r\n            _min = Math.min(_min, a.x);\r\n        }\r\n\r\n        if (_max > screen.width - 28 || _min < 28) {\r\n            dir *= -1;\r\n            for (var i = 0, len = monsters.length; i < len; i++) {\r\n                monsters[i].x += 30*dir;\r\n                monsters[i].y += 30;\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nfunction render() {\r\n    // screen.drawSprite(mSprite[0][0], 10, 10);\r\n\r\n    screen.clear();\r\n\r\n    for (var i = 0, len = monsters.length; i < len; i++) {\r\n        var a = monsters[i];\r\n        screen.drawSprite(a.sprite[spFrame], a.x, a.y);\r\n    }\r\n\r\n    screen.context.save();\r\n    for (var i = 0, len = bullets.length; i < len; i++) {\r\n        screen.drawBullet(bullets[i]);\r\n    }\r\n    screen.context.restore();\r\n\r\n    screen.drawSprite(lazer.sprite, lazer.x, lazer.y);\r\n\r\n};\r\n\r\nfunction main() {\r\n    screen = new Screen(640, 480);\r\n    input = new InputHandeler();\r\n\r\n    var img = new Image();\r\n    img.addEventListener(\"load\", function() {\r\n\r\n        mSprite = [\r\n            [new Sprite(this, 0, 0, 28, 20), new Sprite(this, 0, 20, 28, 20)],\r\n            [new Sprite(this, 29, 0, 28, 20), new Sprite(this, 29, 20, 28, 20)],\r\n            [new Sprite(this, 57, 0, 28, 20), new Sprite(this, 57, 20, 28, 20)]\r\n        ];\r\n\r\n        lSprite = new Sprite(this, 85, 0, 30, 20);\r\n\r\n        init();\r\n        run();\r\n    })\r\n    img.src = \"./images/sprite-small.png\";\r\n};\r\n\r\n$( document ).ready(function() {\r\n    var menu = new Menu();\r\n    // main();\r\n});"],"sourceRoot":"/source/"}