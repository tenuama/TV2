{"version":3,"sources":["app.js"],"names":["menu","gamezone","input","lazer","monsters","lazerImg","monstersImg","pewImg","pews","boomImg","frames","mframe","lvFrame","dir","globalLives","score","animate","crush","pewSound","boom","win","endGame","Menu","constructor","t","$","on","start","fadeOut","Gamezone","init","window","requestAnimationFrame","loop","canvas","end","cancelAnimationFrame","removeClass","text","addClass","fadeIn","play","width","height","document","createElement","context","getContext","append","draw","img","x","y","drawImage","w","h","drawPew","pew","type","fillStyle","fillRect","clear","clearRect","Img","InputHandeler","down","pressed","addEventListener","e","keyCode","isDown","code","isPressed","Pew","v","wasted","update","updateAll","drawAll","callback","Audio","src","sprite","Image","lives","active","i","j","each","index","value","save","len","length","restore","push","Math","random","a","round","screen","splice","max","min","_max","_min","checkHurt","setTimeout","monster","object","danger","ready"],"mappings":"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","file":"app.js","sourcesContent":["var menu, gamezone, input;\r\nvar lazer, monsters = [], lazerImg = [], monstersImg = [], pewImg, pews = [], boomImg = [];\r\nvar frames, mframe, lvFrame, dir, globalLives = 3, score = 0, animate = true;\r\nvar crush, pewSound, boom, win, endGame;\r\n\r\nclass Menu {\r\n    constructor() {\r\n        let t = this;\r\n        $('#startgame').on('click', function() {\r\n            t.start();\r\n        });\r\n    }\r\n    start() {\r\n        $('#menu').fadeOut(function() {\r\n            gamezone = new Gamezone(640, 480);\r\n            init(function() {\r\n                window.requestAnimationFrame(loop, gamezone.canvas);\r\n            });\r\n        });\r\n    }\r\n    end() {\r\n        window.cancelAnimationFrame(loop, gamezone.canvas);\r\n        animate = false;\r\n\r\n        $('.game__start').removeClass('active');\r\n        $('.game__youscore span').text(score);\r\n        $('.game__end').addClass('active');\r\n        $('#menu').fadeIn(function() {\r\n\r\n            if (globalLives > 0) {\r\n                win.play();\r\n            } else {\r\n                endGame.play();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nclass Gamezone {\r\n    constructor(width, height) {\r\n        let t = this;\r\n        t.canvas = document.createElement(\"canvas\");\r\n        t.context = t.canvas.getContext(\"2d\");\r\n        t.canvas.width = t.width = width;\r\n        t.canvas.height = t.height = height;\r\n\r\n        $(\"#gamezone\").append(this.canvas);\r\n    }\r\n    draw(img, x, y) {\r\n        this.context.drawImage(img.img, img.x, img.y, img.w, img.h, x, y , img.w, img.h);\r\n    }\r\n    drawPew(pew) {\r\n        let t = this;\r\n\r\n        if (pew.type === \"alarm\") {\r\n            t.draw(pew.img, pew.x, pew.y);\r\n        } else {\r\n            t.context.fillStyle = \"#00fc00\";\r\n            t.context.fillRect(pew.x, pew.y, pew.w, pew.h);\r\n        }\r\n    }\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.width, this.height);\r\n    }\r\n}\r\n\r\nclass Img {\r\n    constructor(img, x, y, w, h) {\r\n        let t = this;\r\n        t.img = img;\r\n        t.x = x;\r\n        t.y = y;\r\n        t.w = w;\r\n        t.h = h;\r\n    }\r\n}\r\n\r\nclass InputHandeler {\r\n    constructor() {\r\n        let t = this;\r\n        t.down = {};\r\n        t.pressed = {};\r\n\r\n        window.addEventListener(\"keydown\", function(e) {\r\n            t.down[e.keyCode] = true;\r\n        });\r\n        window.addEventListener(\"keyup\", function(e) {\r\n            delete t.down[e.keyCode];\r\n            delete t.pressed[e.keyCode];\r\n        });\r\n    }\r\n    isDown(code) {\r\n        return this.down[code];\r\n    }\r\n    isPressed(code) {\r\n        let t = this;\r\n        if (t.pressed[code]) {\r\n            return false;\r\n        } else if (t.down[code]) {\r\n            return t.pressed[code] = true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\nclass Pew {\r\n    constructor(type, x, y, v) {\r\n        let t = this;\r\n        t.type = type;\r\n        t.x = x;\r\n        t.y = y;\r\n        t.v = v;\r\n        t.wasted = false;\r\n        t.w = 2;\r\n        t.h = 6;\r\n\r\n        if (t.type === \"alarm\") {\r\n            t.img = pewImg;\r\n            t.w = 12;\r\n            t.h = 16;\r\n        }\r\n    }\r\n    update() {\r\n        let t = this;\r\n        t.y += t.v;\r\n    }\r\n}\r\n\r\nvar loop = function() {\r\n    updateAll();\r\n    drawAll();\r\n    if (animate) {\r\n        window.requestAnimationFrame(loop, gamezone.canvas);\r\n    }\r\n};\r\n\r\nfunction init(callback) {\r\n\r\n    frames = 0;\r\n    mframe = 0;\r\n    lvFrame = 50;\r\n    dir = 1;\r\n\r\n    input = new InputHandeler();\r\n\r\n    crush = new Audio();\r\n    crush.src = \"./crush.mp3\";\r\n    pewSound = new Audio();\r\n    pewSound.src = \"./pew.mp3\";\r\n    boom = new Audio();\r\n    boom.src = \"./boom.mp3\";\r\n    win = new Audio();\r\n    win.src = \"./win.mp3\";\r\n    endGame = new Audio();\r\n    endGame.src = \"./endgame.mp3\";\r\n\r\n    var sprite = new Image();\r\n    sprite.src = \"./images/sprite-small2.png\";\r\n    sprite.addEventListener(\"load\", function() {\r\n\r\n        lazerImg = [new Img(this, 85, 0, 30, 20), new Img(this, 85, 20, 30, 20)];\r\n        monstersImg = [\r\n            [new Img(this, 0, 0, 28, 20), new Img(this, 0, 20, 28, 20)],\r\n            [new Img(this, 29, 0, 28, 20), new Img(this, 29, 20, 28, 20)],\r\n            [new Img(this, 57, 0, 28, 20), new Img(this, 57, 20, 28, 20)]\r\n        ];\r\n        boomImg = [new Img(this, 0, 40, 28, 20), new Img(this, 0, 40, 28, 20)];\r\n\r\n        lazer = {\r\n            img: lazerImg[0],\r\n            lives: globalLives,\r\n            x: (gamezone.width - lazerImg[0].w)/2,\r\n            y: gamezone.height - 30,\r\n            w: 28,\r\n            h: 20,\r\n            active: true\r\n        };\r\n\r\n        pewImg = new Img(this, 32, 45, 12, 16);\r\n\r\n        for (var i = 0; i < 3; i++) {\r\n            for (var j = 0; j < 10; j++) {\r\n                monsters[j + 10*i] = {\r\n                    img: monstersImg[i],\r\n                    type: i+1,\r\n                    x: 30 + 40*j,\r\n                    y: 30 + 30*i,\r\n                    w: 28,\r\n                    h: 30\r\n                }\r\n            }\r\n        }\r\n\r\n        callback(); \r\n    });\r\n\r\n   \r\n}\r\n\r\nfunction drawAll() {\r\n    gamezone.clear();\r\n    gamezone.draw(lazer.img, lazer.x, lazer.y);\r\n\r\n    $.each(monsters, function( index, value ) {\r\n      gamezone.draw(value.img[mframe], value.x, value.y);\r\n    });\r\n\r\n    gamezone.context.save();\r\n    for (var i = 0, len = pews.length; i < len; i++) {\r\n        gamezone.drawPew(pews[i]);\r\n    }\r\n    gamezone.context.restore();\r\n}\r\n\r\nfunction updateAll() {\r\n\r\n    if (lazer.active) {\r\n        if (input.isDown(37)) { //left\r\n            lazer.x -= 4;\r\n        }\r\n        if (input.isDown(39)) { //right\r\n            lazer.x += 4;\r\n        }\r\n\r\n        if (input.isPressed(32)) { //space\r\n            pews.push(new Pew(\"\", lazer.x + lazer.w/2, lazer.y + 2, -8));\r\n            pewSound.play();\r\n        }\r\n\r\n        if (Math.random() < 0.02 && monsters.length > 0) {\r\n            var a = monsters[Math.round(Math.random() * (monsters.length - 1))];\r\n            pews.push(new Pew(\"alarm\", a.x + 15, a.y + 15 + 30,  4));\r\n        }\r\n    }\r\n\r\n    $.each(pews, function( index, value ) {\r\n\r\n        if (value) {\r\n            value.update();\r\n\r\n            if (value.y  < 0 || value.y > screen.height || value.wasted) {\r\n                pews.splice(index, 1);\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n\r\n\r\n    lazer.x = Math.max(Math.min(lazer.x, gamezone.width - (30 + lazerImg[0].w)), 30);\r\n\r\n    frames++;\r\n    if (frames % lvFrame === 0) {\r\n\r\n        mframe = (mframe + 1) % 2;\r\n\r\n        var _max = 0,\r\n            _min = gamezone.width;\r\n\r\n        for (var i = 0, len = monsters.length; i < len; i++) {\r\n            var a = monsters[i];\r\n            a.x += 30 * dir;\r\n\r\n            _max = Math.max(_max, a.x + 28);\r\n            _min = Math.min(_min, a.x);\r\n        }\r\n\r\n        if (_max > gamezone.width - 30 || _min < 30) {\r\n\r\n            dir *= -1;\r\n            for (var i = 0, len = monsters.length; i < len; i++) {\r\n                monsters[i].x += 30*dir;\r\n                monsters[i].y += 30;\r\n            }\r\n        }\r\n    }\r\n\r\n    $.each(pews, function( index, pew ) {\r\n        if (pew.type === \"alarm\" && lazer.active && checkHurt(lazer, pew)) {\r\n            pew.wasted = true;\r\n            globalLives -= 1;\r\n            lazer.img = lazerImg[1];\r\n\r\n            if (globalLives > 0) {\r\n\r\n                lazer.active = false;\r\n                boom.play();\r\n\r\n                setTimeout(function(){ \r\n                    init(function() {}); \r\n                }, 2000);\r\n                \r\n            } else {\r\n                boom.play();\r\n                setTimeout(function(){ \r\n                    menu.end();\r\n                }, 2000);\r\n                \r\n            }\r\n        }\r\n\r\n        $.each(monsters, function( i, monster ) {\r\n            if (monster && pew.type === \"\" && checkHurt(monster, pew)) {\r\n                score += monster.type*10;\r\n                pew.wasted = true;\r\n                monster.img = boomImg;\r\n                crush.play();\r\n\r\n                setTimeout(function(){ \r\n                    monsters.splice(i, 1);\r\n                    if (monsters.length === 0) {\r\n                        menu.end();\r\n                    }\r\n                }, 100);\r\n            }\r\n        });\r\n\r\n    });\r\n}\r\n\r\nfunction checkHurt(object, danger) {\r\n\r\n    return ( !(danger.wasted) && (\r\n        (danger.x >= object.x - danger.w) && \r\n        (danger.x <= object.x + object.w + danger.w/2) &&\r\n        (danger.y >= object.y) && \r\n        (danger.y + danger.h <= object.y + object.h)\r\n    ) );\r\n}\r\n\r\n$(document).ready(function() {\r\n    menu = new Menu();\r\n})"],"sourceRoot":"/source/"}